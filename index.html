<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personal Website</title>
    <link rel="stylesheet" href="static/common-styles.css" />
    <style>
      :root {
        --bg-color: #111111;
        --text-color: #e0e0e0;
        --accent-color: #00a86b;
        --secondary-color: #333333;
      }
      body {
        font-family: "Arial", sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        line-height: 1.6;
        min-height: 100vh;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
      }
      .main-content {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        position: relative;
      }
      .container {
        max-width: 800px;
        text-align: left;
        position: relative;
        z-index: 1;
      }
      h1 {
        font-size: 3rem;
        margin-bottom: 20px;
        color: var(--accent-color);
        font-weight: 300;
      }
      /* Overwrite header styles */
      header {
        background-color: var(--bg-color);
        border-bottom: 1px solid var(--accent-color);
      }
      header .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 10px 20px;
      }
      header #branding h1 {
        color: var(--accent-color);
      }
      header nav ul li a {
        color: var(--text-color);
      }
      header nav ul li a:hover {
        color: var(--accent-color);
      }
      /* Fix dropdown menu */
      .dropdown-content {
        display: none;
        position: absolute;
        background-color: var(--bg-color);
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        border-radius: 0 0 4px 4px;
        border: 1px solid var(--accent-color);
        border-top: none;
      }
      .dropdown:hover .dropdown-content {
        display: block;
      }
      .dropdown-content a {
        color: var(--text-color);
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        transition: background-color 0.3s, color 0.3s;
      }
      .dropdown-content a:hover {
        background-color: var(--accent-color);
        color: var(--bg-color);
      }
      /* Overwrite footer styles */
      footer {
        background-color: var(--bg-color);
        border-top: 1px solid var(--accent-color);
        color: var(--text-color);
        text-align: center;
        padding: 10px 0;
      }
      footer .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      footer p {
        margin: 0;
      }
      /* Neural network background */
      .ai-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        opacity: 0.25;
      }
      .connection {
        position: absolute;
        height: 1px;
        background-color: var(--accent-color);
        opacity: 0.5;
        transform-origin: left center;
      }
      .node {
        position: absolute;
        width: 4px;
        height: 4px;
        background-color: var(--accent-color);
        border-radius: 50%;
        animation: pulse 4s infinite;
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
          opacity: 0.5;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.7;
        }
        100% {
          transform: scale(1);
          opacity: 0.5;
        }
      }
      /* SVG colors */
      .neural-network-svg .primary,
      .neural-network-svg .secondary,
      .neural-network-svg .accent {
        fill: var(--accent-color);
      }
      /* Style for the link buttons */
      .links .btn {
        display: inline-block;
        padding: 10px 20px;
        background-color: var(--secondary-color);
        color: var(--text-color);
        text-decoration: none;
        border-radius: 5px;
        transition: background-color 0.3s ease;
        margin-right: 10px;
        margin-bottom: 10px;
      }
      .links .btn:hover {
        background-color: var(--accent-color);
        color: var(--bg-color);
      }
      /* Easter Egg Styles */
      #easterEgg {
        position: fixed;
        bottom: 10px;
        right: 10px;
        width: 20px;
        height: 20px;
        background-color: var(--accent-color);
        border-radius: 50%;
        cursor: pointer;
        opacity: 0.3;
        transition: opacity 0.3s ease;
        z-index: 1000;
      }
      #easterEgg:hover {
        opacity: 1;
      }
      .konami-code {
        position: fixed;
        bottom: 10px;
        left: 10px;
        font-size: 12px;
        color: var(--accent-color);
        opacity: 0.05;
        z-index: 1000;
      }
      #bee {
        position: fixed;
        width: 40px;
        height: 30px;
        display: none;
        cursor: pointer;
        z-index: 1000;
      }
      @keyframes fly {
        to {
          transform: translate(var(--flyX), var(--flyY)) rotate(var(--rotate));
        }
      }
      /* Services Dropdown Menu */
      header nav ul li.has-dropdown {
        position: relative;
      }
      header nav ul li.has-dropdown:hover .dropdown {
        display: block;
      }
      header nav ul li .dropdown {
        display: none;
        position: absolute;
        background-color: var(--bg-color);
        min-width: 160px;
        box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
        z-index: 1;
        border-radius: 0 0 4px 4px;
        border: 1px solid var(--accent-color);
        border-top: none;
      }
      header nav ul li .dropdown li {
        display: block;
        width: 100%;
      }
      header nav ul li .dropdown li a {
        color: var(--text-color);
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        transition: background-color 0.3s, color 0.3s;
      }
      header nav ul li .dropdown li a:hover {
        background-color: var(--accent-color);
        color: var(--bg-color);
      }
      /* Updated Modal Styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 2000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.8);
      }

      .modal-content {
        background-color: var(--bg-color);
        margin: 2% auto;
        padding: 20px;
        border: 1px solid var(--accent-color);
        width: 90%;
        max-width: 1200px;
        height: 90vh;
        position: relative;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .close {
        color: var(--accent-color);
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s ease;
      }

      .close:hover,
      .close:focus {
        color: var(--text-color);
        text-decoration: none;
        cursor: pointer;
      }

      #gameFrame {
        width: 100%;
        height: calc(100% - 40px);
        border: none;
      }
    </style>
  </head>
  <body>
    <header id="main-header"></header>

    <div class="main-content">
      <div class="ai-bg" id="aiBg"></div>
      <div class="container">
        <h1 id="name"></h1>
        <div id="description"></div>
        <div class="links" id="links"></div>
      </div>
    </div>

    <div id="gameModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <iframe id="gameFrame"></iframe>
      </div>
    </div>

    <div id="easterEgg" title="Curious? Click me!"></div>
    <div class="konami-code">↑↑↓↓←→←→BA</div>

    <div id="bee"></div>

    <script src="config.js"></script>
    <script src="static/svgPaths.js"></script>
    <script src="static/logger.js"></script>
    <script src="static/headerConfig.js"></script>
    <script src="static/header.js"></script>
    <script>
      function createNode(x, y) {
        const node = document.createElement("div");
        node.className = "node";
        node.style.left = `${x}px`;
        node.style.top = `${y}px`;
        return node;
      }

      function createConnection(x1, y1, x2, y2) {
        const connection = document.createElement("div");
        connection.className = "connection";
        const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        const angle = (Math.atan2(y2 - y1, x2 - x1) * 180) / Math.PI;
        connection.style.width = `${length}px`;
        connection.style.left = `${x1}px`;
        connection.style.top = `${y1}px`;
        connection.style.transform = `rotate(${angle}deg)`;
        return connection;
      }

      function generateAIBackground() {
        const aiBg = document.getElementById("aiBg");
        const width = window.innerWidth;
        const height = window.innerHeight;
        const nodeCount = 20;
        const nodes = [];

        for (let i = 0; i < nodeCount; i++) {
          const x = Math.random() * width;
          const y = Math.random() * height;
          const node = createNode(x, y);
          nodes.push({ x, y, element: node });
          aiBg.appendChild(node);
        }

        for (let i = 0; i < nodes.length; i++) {
          for (let j = i + 1; j < nodes.length; j++) {
            if (Math.random() > 0.5) continue;
            const connection = createConnection(
              nodes[i].x,
              nodes[i].y,
              nodes[j].x,
              nodes[j].y
            );
            aiBg.appendChild(connection);
          }
        }
      }

      function populateContent() {
        document.title = `${config.name} - ${config.title}`;
        document.getElementById("name").textContent = config.name;

        const descriptionElement = document.getElementById("description");
        config.description.forEach((para) => {
          const p = document.createElement("p");
          p.textContent = para;
          descriptionElement.appendChild(p);
        });

        const linksElement = document.getElementById("links");
        config.links.forEach((link) => {
          const a = document.createElement("a");
          a.href = link.url;
          a.textContent = link.name;
          a.className = "btn";
          a.target = "_blank";
          linksElement.appendChild(a);
        });
      }

      function playGame(gameFile) {
        const timestamp = new Date().getTime();
        document.getElementById("gameFrame").src = `${gameFile}?v=${timestamp}`;
        document.getElementById("gameModal").style.display = "block";
      }

      document
        .getElementById("easterEgg")
        .addEventListener("click", function () {
          playGame(config.games[0].file);
        });

      let konamiCode = [
        "ArrowUp",
        "ArrowUp",
        "ArrowDown",
        "ArrowDown",
        "ArrowLeft",
        "ArrowRight",
        "ArrowLeft",
        "ArrowRight",
        "b",
        "a",
      ];
      let konamiCodePosition = 0;

      document.addEventListener("keydown", function (e) {
        if (e.key === konamiCode[konamiCodePosition]) {
          konamiCodePosition++;

          if (konamiCodePosition === konamiCode.length) {
            playGame(config.games[0].file);
            konamiCodePosition = 0;
          }
        } else {
          konamiCodePosition = 0;
        }
      });

      function drawBee(context, x, y, width, height) {
        context.save();
        context.translate(x + width / 2, y + height / 2);

        // Body
        context.fillStyle = "gold";
        context.beginPath();
        context.ellipse(0, 0, width / 2, height / 2, 0, 0, Math.PI * 2);
        context.fill();

        // Stripes
        context.fillStyle = "black";
        context.fillRect(-5, -15, 30, 7);
        context.fillRect(-5, 0, 30, 7);

        // Wings
        context.fillStyle = "rgba(255, 255, 255, 0.7)";
        context.beginPath();
        context.ellipse(0, -height / 2, 15, 10, Math.PI / 4, 0, Math.PI * 2);
        context.fill();

        // Eyes
        context.fillStyle = "white";
        context.beginPath();
        context.arc(15, -5, 5, 0, Math.PI * 2);
        context.fill();
        context.fillStyle = "black";
        context.beginPath();
        context.arc(17, -5, 2, 0, Math.PI * 2);
        context.fill();

        // Stinger
        context.beginPath();
        context.moveTo(-width / 2, 0);
        context.lineTo(-width / 2 - 5, 5);
        context.lineTo(-width / 2, 10);
        context.closePath();
        context.fill();

        context.restore();
      }

      function createBeeElement() {
        const beeCanvas = document.createElement("canvas");
        beeCanvas.width = 40;
        beeCanvas.height = 30;
        const beeCtx = beeCanvas.getContext("2d");
        drawBee(beeCtx, 0, 0, 40, 30);

        const bee = document.getElementById("bee");
        bee.style.background = `url(${beeCanvas.toDataURL()})`;
        bee.style.backgroundSize = "contain";
        bee.style.backgroundRepeat = "no-repeat";
        return bee;
      }

      function getRandomPosition(edge) {
        const positions = {
          left: () => ({ x: -50, y: Math.random() * window.innerHeight }),
          right: () => ({
            x: window.innerWidth + 50,
            y: Math.random() * window.innerHeight,
          }),
          top: () => ({ x: Math.random() * window.innerWidth, y: -50 }),
          bottom: () => ({
            x: Math.random() * window.innerWidth,
            y: window.innerHeight + 50,
          }),
        };
        return positions[edge]();
      }

      function showBee() {
        const bee = createBeeElement();
        const edges = ["left", "right", "top", "bottom"];
        const startEdge = edges[Math.floor(Math.random() * edges.length)];
        const endEdge = edges.filter(
          (e) =>
            e !== startEdge &&
            ((e === "left" && startEdge === "right") ||
              (e === "right" && startEdge === "left") ||
              (e === "top" && startEdge === "bottom") ||
              (e === "bottom" && startEdge === "top"))
        )[0];

        const start = getRandomPosition(startEdge);
        const end = getRandomPosition(endEdge);

        bee.style.left = `${start.x}px`;
        bee.style.top = `${start.y}px`;
        bee.style.display = "block";

        const flyX = end.x - start.x;
        const flyY = end.y - start.y;
        const rotate = (Math.atan2(flyY, flyX) * 180) / Math.PI;

        bee.style.setProperty("--flyX", `${flyX}px`);
        bee.style.setProperty("--flyY", `${flyY}px`);
        bee.style.setProperty("--rotate", `${rotate}deg`);

        bee.animate(
          [
            { transform: "translate(0, 0) rotate(0deg)" },
            {
              transform:
                "translate(var(--flyX), var(--flyY)) rotate(var(--rotate))",
            },
          ],
          {
            duration: 5000,
            easing: "ease-in-out",
            fill: "forwards",
          }
        ).onfinish = () => {
          bee.style.display = "none";
        };
      }

      function startBeeGame() {
        playGame(config.games[1].file);
      }

      setTimeout(showBee, Math.random() * (300000 - 30000) + 3000);

      document.getElementById("bee").addEventListener("click", startBeeGame);

      let beeTyped = "";
      document.addEventListener("keydown", function (e) {
        beeTyped += e.key.toLowerCase();
        beeTyped = beeTyped.slice(-3);
        if (beeTyped === "bee") {
          startBeeGame();
        }
      });

      generateAIBackground();
      populateContent();

      const modal = document.getElementById("gameModal");
      const span = document.getElementsByClassName("close")[0];

      span.onclick = function () {
        modal.style.display = "none";
      };

      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };
      document.addEventListener("DOMContentLoaded", function () {
        if (typeof Header === "undefined") {
          console.error(
            "Header is not defined. Check if header.js is loaded correctly."
          );
          return;
        }
        var header = new Header(headerConfig);
        header.render("main-header");

        // Ensure the footer is styled correctly
        var footer = document.querySelector("footer");
        if (footer) {
          footer.style.backgroundColor = "var(--bg-color)";
          footer.style.borderTop = "1px solid var(--accent-color)";
          footer.style.color = "var(--text-color)";
          footer.style.textAlign = "center";
          footer.style.padding = "10px 0";

          var footerContainer = footer.querySelector(".container");
          if (footerContainer) {
            footerContainer.style.maxWidth = "1200px";
            footerContainer.style.margin = "0 auto";
            footerContainer.style.padding = "0 20px";
          }
        }
        // Ensure correct structure for services dropdown
        var servicesMenuItem = document.querySelector(
          'header nav ul li a[href="#services"]'
        );
        if (servicesMenuItem) {
          var parentLi = servicesMenuItem.parentElement;
          parentLi.classList.add("has-dropdown");
          var dropdown = parentLi.querySelector(".dropdown");
          if (dropdown) {
            var dropdownItems = dropdown.querySelectorAll("a");
            dropdownItems.forEach(function (item) {
              if (item.parentElement.tagName !== "LI") {
                var li = document.createElement("li");
                item.parentNode.insertBefore(li, item);
                li.appendChild(item);
              }
            });
          }
        }

        // Ensure easter egg and Konami code elements exist
        var body = document.body;
        if (!document.getElementById("easterEgg")) {
          var easterEgg = document.createElement("div");
          easterEgg.id = "easterEgg";
          easterEgg.title = "Curious? Click me!";
          body.appendChild(easterEgg);
        }
        if (!document.querySelector(".konami-code")) {
          var konamiCode = document.createElement("div");
          konamiCode.className = "konami-code";
          konamiCode.textContent = "↑↑↓↓←→←→BA";
          body.appendChild(konamiCode);
        }
      });
    </script>
  </body>
</html>
